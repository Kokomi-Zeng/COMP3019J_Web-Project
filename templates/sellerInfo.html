{#
    This HTML file is page for seller to check and modify their information.
    Seller can also add items in this page.
    It has such funtions:
    1. get_session (Extends)
    1. log_out (Extends)
    2. get_and_render_seller_info
    3. render_add
    4. add_item
    5. upload_item_img

    Using js:
    1. alert.js (Extends)
    2. get_user_image.js (Extends)
    3. render_user_info.js (Extends)

    JS functions:
    1. get_user_image (Extends)
    2. alert_message (Extends)
    3. render_user_info (Extends)
#}

{% extends "base_personInfo.html" %}

{% block nav_bar %}
    <button class="nav-button" id="info" onclick="get_and_render_seller_info()">info</button>
{% endblock %}

{% block script %}
    <script>
    let container;

    {#when session is loaded#}
    $(document).on("sessionLoaded", function () {
        container = $(".container");

        {#set title#}
        $("title").innerText = name;

        {#Get and render seller information automatically#}
        get_and_render_seller_info();
    })

    {#This function is to get and render seller information#}
    function get_and_render_seller_info(){
        $.ajax({
            url:"/seller/sellerInfo",
            type:"get",
            contentType: "application/json",
            dataType: "json",
            data:{phone:phone},
            success:function (data){
                render_user_info(data);
            }
            
        })
    }

    {#This function is to create items#}
    function create_item(name, price, storage, description, formdata){
        $.ajax({
            url:'/products/addItem',
            type:'get',
            contentType: "application/json",
            dataType: "json",
            data:{
                seller_phone:phone,
                description:description,
                storage:storage,
                price:price,
                product_name:name
            },
            success:function (data){
                if (data.success){

                    {#Create item successfully: begin to upload item image#}
                    upload_item_img(formdata, data.product_id);
                    alert(data.message);

                    {#reload page#}
                    render_add();
                }else {
                    alert(data.message);
                }
            }
        })
    }

    {#This function is to upload image depend on fromdata and product id#}
    function upload_item_img(formdata, product_id){
        $.ajax({
            url:"/images/upload_image_product?product_id=" + product_id,
            type:"post",
            data:formdata,
            dataType:"json",
            processData:false,
            contentType:false,
            success:function (data){
                if (!data.success) {
                    alert(data.message);
                }
            }
        })
    }
    </script>
{% endblock %}

{% block body %}
    <div class="container"></div>
{% endblock %}